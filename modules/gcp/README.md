# gcp wireguard setup

Check parent module for documentation

<!-- BEGINNING OF PRE-COMMIT-TERRAFORM DOCS HOOK -->
## Requirements

| Name | Version |
|------|---------|
| <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) | >= 1.3.0 |
| <a name="requirement_google"></a> [google](#requirement\_google) | >= 5.0.0 |

## Providers

| Name | Version |
|------|---------|
| <a name="provider_google"></a> [google](#provider\_google) | >= 5.0.0 |

## Modules

| Name | Source | Version |
|------|--------|---------|
| <a name="module_wg_configs"></a> [wg\_configs](#module\_wg\_configs) | ../wg-configs | n/a |

## Resources

| Name | Type |
|------|------|
| [google_compute_address.this](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_address) | resource |
| [google_compute_firewall.this](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_firewall) | resource |
| [google_compute_instance.this](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_instance) | resource |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_clients"></a> [clients](#input\_clients) | Wireguard clients/peers list with configs | <pre>list(object({<br>    name            = string                                   # should be unique in list<br>    ip              = string                                   # client uniq IP form var.network_cidr range in cidr format, TODO: we maybe can automate this IP creation inside module<br>    route_ip_ranges = string                                   # comma separated IP ranges that the client should route via the VPN in format "1.2.3.4/32,1.1.1.1/16", set "0.0.0.0/0" to route all traffic through VPN<br>    public_key      = string                                   # public key of client/peer, both private and public keys can be generated by using wg cli and client private key: `wg pubkey < privatekey-client1 > publickey-client1`, # TODO: we probably need to have this set as sensitive<br>    private_key     = optional(string, "{client-private-key}") # client private key, pass in case you want to get fully prepared to use client_configs output, can be generated using wg cli: `wg genkey > privatekey-client1`<br>  }))</pre> | `[]` | no |
| <a name="input_dns"></a> [dns](#input\_dns) | Custom DNS server | `string` | `"8.8.8.8"` | no |
| <a name="input_ingress"></a> [ingress](#input\_ingress) | The IPs/CIDRs from where the instance wireguard and ssh port are open to connect | `list(any)` | <pre>[<br>  "0.0.0.0/0"<br>]</pre> | no |
| <a name="input_instance_type"></a> [instance\_type](#input\_instance\_type) | The wireguard server machine instance type | `string` | `"f1-micro"` | no |
| <a name="input_keep_alive"></a> [keep\_alive](#input\_keep\_alive) | CLients peer connection persistance keep alive config | `number` | `25` | no |
| <a name="input_name"></a> [name](#input\_name) | The name to use of instance/machine | `string` | n/a | yes |
| <a name="input_network_cidr"></a> [network\_cidr](#input\_network\_cidr) | Wireguard network CIDR which should not overlap with local/server networks | `string` | `"10.11.11.0/24"` | no |
| <a name="input_region"></a> [region](#input\_region) | The region where wireguard server instance and related resources will be created | `string` | `"europe-central2"` | no |
| <a name="input_server_port"></a> [server\_port](#input\_server\_port) | Wireguard server port number | `number` | `51820` | no |
| <a name="input_server_private_key"></a> [server\_private\_key](#input\_server\_private\_key) | Wireguard server private key, which can be generated using wg cli tool: `wg genkey > privatekey-server` | `string` | n/a | yes |
| <a name="input_server_public_key"></a> [server\_public\_key](#input\_server\_public\_key) | Wireguard server public key, which can be generated using wg cli tool and server private key: `wg pubkey < privatekey-server > publickey-server` | `string` | n/a | yes |
| <a name="input_ssh_keys"></a> [ssh\_keys](#input\_ssh\_keys) | The ssh usernames and public keys to set in wireguard server instance to be able to connect to it from local to do some debugging | <pre>list(object({<br>    username   = string<br>    public_key = string # the public key is in OpenSSH format (for example: 'ssh-rsa AAAAC3NzaC1lZDI... me@my-domain')<br>  }))</pre> | `[]` | no |
| <a name="input_ubuntu_version"></a> [ubuntu\_version](#input\_ubuntu\_version) | The version of ubuntu to use | `string` | `"ubuntu-os-cloud/ubuntu-2004-focal-v20220712"` | no |
| <a name="input_vpc_name"></a> [vpc\_name](#input\_vpc\_name) | The vpc name where wireguard server instance will be created | `string` | n/a | yes |
| <a name="input_zone"></a> [zone](#input\_zone) | The zone where wireguard server instance will be created | `string` | `"europe-central2-a"` | no |

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_client_configs"></a> [client\_configs](#output\_client\_configs) | The client configs to copy/set in their laptops/machines /etc/wireguard/wg0.conf file |
| <a name="output_public_ip"></a> [public\_ip](#output\_public\_ip) | n/a |
<!-- END OF PRE-COMMIT-TERRAFORM DOCS HOOK -->
