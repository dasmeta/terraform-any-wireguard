# wg-configs

<!-- BEGINNING OF PRE-COMMIT-TERRAFORM DOCS HOOK -->
# This is tooling/helper central module for wireguard server and client configs generation
it actually have no any provider and just preparing server and client config files based on template

## Resources


## Examples

```hcl
module "this" {
  source = "../../" # check/set terraform registry value before using this in your setups: https://registry.terraform.io/modules/dasmeta/wireguard

  server_public_ip   = "1.2.3.4"
  server_private_key = "CEXfZgx+G/rzVOawGWaMhFYKkMeTqI0BSr99Shbeb28="
  server_public_key  = "6sPQH8RvnPmS8vGUpF050/S+PZu4yYQFowF1WAga7xg="

  clients = [
    {
      name            = "client1"
      public_key      = "lJd5CessDQ9eay8sUEA15/rNl+6eNcbaTT/jnQ2qhig="
      private_key     = "eDWDX79XqXxK0nHwuvxq/yrp0tntk5ASKW8FeRTgBnQ="
      ip              = "10.11.11.1/32"
      route_ip_ranges = "0.0.0.0/0" # all traffic goes through vpn
    }
  ]
}
```

## Providers

No providers.

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_client_configs"></a> [client\_configs](#output\_client\_configs) | Wireguard clients configs to copy/set in their laptops/machines /etc/wireguard/wg0.conf file |
| <a name="output_startup_script"></a> [startup\_script](#output\_startup\_script) | Wireguard server virtual-machine/instance init scrypt to create all needed configs for server |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_clients"></a> [clients](#input\_clients) | Wireguard clients/peers list with configs | <pre>list(object({<br>    name            = string                                   # should be unique in list<br>    ip              = string                                   # client uniq IP form var.network_cidr range in cidr format, TODO: we maybe can automate this IP creation inside module<br>    route_ip_ranges = string                                   # comma separated IP ranges that the client should route via the VPN in format "1.2.3.4/32,1.1.1.1/16", set "0.0.0.0/0" to route all traffic through VPN<br>    public_key      = string                                   # public key of client/peer, both private and public keys can be generated by using wg cli and client private key: `wg pubkey < privatekey-client1 > publickey-client1`, # TODO: we probably need to have this set as sensitive<br>    private_key     = optional(string, "{client-private-key}") # client private key, pass in case you want to get fully prepared to use client_configs output, can be generated using wg cli: `wg genkey > privatekey-client1`<br>  }))</pre> | `[]` | no |
| <a name="input_dns"></a> [dns](#input\_dns) | Custom DNS server | `string` | `"8.8.8.8"` | no |
| <a name="input_ingress"></a> [ingress](#input\_ingress) | The IPs/CIDRs from where the instance wireguard and ssh port are open to connect | `list(any)` | <pre>[<br>  "0.0.0.0/0"<br>]</pre> | no |
| <a name="input_keep_alive"></a> [keep\_alive](#input\_keep\_alive) | CLients peer connection persistance keep alive config | `number` | `25` | no |
| <a name="input_network_cidr"></a> [network\_cidr](#input\_network\_cidr) | Wireguard network CIDR which should not overlap with local/server networks | `string` | `"10.11.11.0/24"` | no |
| <a name="input_server_port"></a> [server\_port](#input\_server\_port) | Wireguard server port number | `number` | `51820` | no |
| <a name="input_server_private_key"></a> [server\_private\_key](#input\_server\_private\_key) | Wireguard server private key, which can be generated using wg cli tool: `wg genkey > privatekey-server` | `string` | n/a | yes |
| <a name="input_server_public_ip"></a> [server\_public\_ip](#input\_server\_public\_ip) | Wireguard server public static IP | `string` | n/a | yes |
| <a name="input_server_public_key"></a> [server\_public\_key](#input\_server\_public\_key) | Wireguard server public key, which can be generated using wg cli tool and server private key: `wg pubkey < privatekey-server > publickey-server` | `string` | n/a | yes |
<!-- END OF PRE-COMMIT-TERRAFORM DOCS HOOK -->
